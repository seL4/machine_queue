#!/bin/bash

if [ "${SCRIPT_PATH}" == "" ]; then
    echo "This script should not be called directly! Please use mq.sh"
    exit -1
fi

function IsSystemValid() {
    local system=$1
    [ -e "${SCRIPT_PATH}/scripts/systems/${system}" ]
}

function SystemList() {
    (
	cd ${SCRIPT_PATH}/scripts/systems/
	echo *
    )
}

for system in `SystemList`
do
    . ${SCRIPT_PATH}/scripts/systems/${system}
done

function OutputSystemList() {
    local system=""
    printf "+------------+------+---------+--------------+----------------+-------+-------+--------+\n"
    printf "| Name       | Arch | ISA     | SoC          | CPU            | Cores | RAM   | MaxCLK |\n"
    printf "+------------+------+---------+--------------+----------------+-------+-------+--------+\n"
    for system in `SystemList`
    do
        printf "| %10s " ${system}
        printf "| %4s " `Arch_${system}`
        printf "| %7s " `ISA_${system}`
        printf "| %12s " `SOC_${system}`
        printf "| %14s " `CPU_${system}`
        printf "| %5s " `Cores_${system}`
        printf "| %5s " `RAM_${system}`
        printf "| %6s " `MaxCLK_${system}`
        printf "|\n"
    done
    printf "+------------+------+---------+--------------+----------------+-------+-------+--------+\n"
    OutputPoolList
}

function SystemCorrectNumberOfFiles() {
    local system=$1
    local num=$2
    local system_num=$(SystemNumFiles_${system})
    [ "${num}" -eq "${system_num}" ]
}

function SystemPowerOff() {
    local system=$1
    SystemPowerOff_${system}
}

function SystemRunImage() {
    local system=$1
    shift
    SystemRunImage_${system} "$@"
}
